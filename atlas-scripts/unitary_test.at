<aql.at

set is_unitary_temp (Param p)=bool:
   let G=real_form(p) in let ic=infinitesimal_character(p) in
   let rd=root_datum(G) in
   if is_integral(rd,ic-rho(G)) and is_regular(rd,ic) then
   prints("This is regular integral"); is_good_Aq(p)
    else prints("now checking for equal_rank wf Aq");
      if (is_equal_rank(G) and is_integral(rd,ic-rho(G)) and
        is_weakly_fair_Aq(p)) then true
     else prints("now checking if real_induced or uneq_rank_Aq");
      if is_integral(rd,2*ic) and
      (is_real_induced_from_one_dimensional(p) or is_weakly_fair_Aq(p))
         then true
     else prints("now computing form"); is_unitary(p) fi fi fi